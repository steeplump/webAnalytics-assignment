---
title: "IST2334: Web and Network Analytics Assignment"
author: ""
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Group Members:

Name            | Student ID
----------------|------------
Wong Yuen-Yi    | 17112723
Wong Wei Chean  | 18000133


## Introduction

In this assignment, we have chosen an interesting data set of user interactions and uploads to Food.com, and subsequently performed three distinctive areas of analysis on the data. For this project, our aim is to:

* analyse the opinions of the users to determine their feelings about the recipes (eg. were they satisfied, or did they have any negative experiences?) through sentiment analysis,
* find out how certain characteristics about a recipe influences its rating, and
* perform market basket analysis on the dataset to study ingredient patterns across different recipes. 

Through performing these analysis, our hope is to be able to extract meaningful information from the large set of data. 

## The Data Set

The data set used in this assignment is by Shuyang Li and Bodhisattwa Prasad Majumder, taken from [Kaggle](https://www.kaggle.com/shuyangli94/food-com-recipes-and-user-interactions?select=PP_recipes.csv). This data set contains over 180,000 recipes and 700,000 recipe review uploads to Food.com over the past 18 years. Here, we have multiple CSV files that contain data about the recipes on the site, user information, and user interactions. 

We will use several libraries to conduct our analysis for our project:

```{r}
library(tidyverse)
library(tidytext)
library(tidyr)
library(dplyr)
library(igraph)
library(ggplot2)
```

Subsequently, we will load the relevant dataset files to conduct analysis:

```{r}
recipes <- read_csv("foodcom_dataset/RAW_recipes.csv")
users <- read_csv("foodcom_dataset/PP_users.csv")
interactions <- read_csv("foodcom_dataset/RAW_interactions.csv")
```

```{r}
summary(recipes)
summary(users)
summary(interactions)
```

There are 231,637 recipe entries, each with 12 columns to describe them, such as recipe name, expected duration, date of submission, contributor, number of steps, and ingredients. As for the user information, there are 25,075 entries and 6 columns of user data, each describing the cooking techniques encountered by the user, recipes interacted with, number of interactions, ratings given to recipes and total number of ratings given. The last file contains information about user interactions on the site, which consists of 1,132,367 entries and 5 columns, which describe the interactions by the user ID, recipe ID, date published, rating and review comments. 

These files contain large amounts of data; however, in this form, they do not provide any meaningful insights about the success of the website or recipes published on the website. As such, we have taken the opportunity to analyse this set of data to obtain indicative insights that will help us to understand better whether or not the website or certain recipes are successfully fulfilling the needs and wants of the users.

## The Analysis

In this section, we will explore three different types of analysis conducted on the Food.com dataset from Kaggle. 

### Sentiment Analysis

As stated in the aim of our project, we intend to use the dataset to discover the general opinions of the users to determine their feelings and opinions about the recipes on Food.com. This can be done through sentiment analysis, or opinion mining, which is a technique used to extract, quantify or identify subjective information. We can apply sentiment analysis on the reviews of the recipes published on Food.com to effectively analyse the position or the thoughts of the users about the recipes on the website.

For this assignment, we will be performing sentiment analysis on 10 top-rated recipes and on 10 recipes with the the lowest rating. 

```{r}
#remove recipes without rating from interactions
pp_interactions <- na.omit(interactions)

#load recipe with 5-star rating
top_recipes <- pp_interactions %>%
  arrange(rating) %>%
  tail(10)

#load recipe with 0-star rating
worst_recipes <- pp_interactions %>%
  filter(rating == 1) %>%
  head(10)

print(top_recipes)
print(worst_recipes)
```

Before the lexicon is applied to the dataset, first we must perform some pre-processing works, such as removing stop words and special characters from the review texts. This is because stop words and special characters may interfere with the integrity of the results of the sentiment analysis. 

```{r}
#load list of stop words from the Tidytext package
data("stop_words")

#tokenise and remove stop words from top_recipes
pp_top_recipes <- top_recipes %>% unnest_tokens(word, review) %>% anti_join(stop_words) %>% 
print(pp_top_recipes)

#tokenise and remove stop words from worst_recipes
pp_worst_recipes <- worst_recipes %>% unnest_tokens(word, review) %>% anti_join(stop_words)
print(pp_worst_recipes)
```

We will use the [Bing lexicon](https://www.cs.uic.edu/~liub/FBS/sentiment-analysis.html) to get sentiments from the reviews. The Bing lexicon helps categorise the text by classifying words and their associations with two sentiments (negative and positive).

```{r}
#get sentiments from pp_top_recipes
top_sentiments <- pp_top_recipes %>% 
  inner_join(get_sentiments("bing")) %>%
  count(word, sentiment, sort = TRUE) %>%
  ungroup()

#get sentiments from pp_worst_recipes
worst_sentiments <- pp_worst_recipes %>%
  inner_join(get_sentiments("bing")) %>%
  count(word, sentiment, sort = TRUE) %>%
  ungroup()

print(top_sentiments)
print(worst_sentiments)
```

To better visualise the data, we can plot the sentiment words against their frequency for `top_sentiments` and `worst_sentiments`. 

```{r}
#visualise top_sentiments
top_sentiments %>%
  group_by(sentiment) %>%
  top_n(10) %>%
  ungroup() %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n, fill = sentiment)) + 
  geom_col(show.legend = FALSE) +
  facet_wrap(~sentiment, scales = "free_y") +
  labs(y = "Sentiments of 10 Highest-Rated Recipes",
       x = NULL) +
  coord_flip()

#visualise worst_sentiments
worst_sentiments %>%
  group_by(sentiment) %>%
  top_n(10) %>%
  ungroup() %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n, fill = sentiment)) + 
  geom_col(show.legend = FALSE) +
  facet_wrap(~sentiment, scales = "free_y") +
  labs(y = "Sentiments of 10 Lowest-Rated Recipes",
       x = NULL) +
  coord_flip()
```

From the above, we can see that the number of positive sentiments for the 10 highest-rated recipes is much larger than the number of positive sentiments for the 10 lowest-rated recipes. In the same manner, the number of negative sentiments for the 10 lowest-rated recipes is larger than the number of negative sentiments for the 10 highest-rated recipes.

### Relationships



### Market Basket Analysis



## Lessons Learned



## Reflections


## References 

1. Shuyang Li, “Food.com Recipes and Interactions.” Kaggle, 2019, doi: 10.34740/KAGGLE/DSV/783630.
